# 음성/텍스트 복지서비스 예약 취소 테스트 가이드

## 🎯 테스트 준비
1. 백엔드 서버 실행: `cd backend-main && npm run dev` (포트 9090)
2. 프론트엔드 실행: `cd frontend-main && npm start` (포트 3000)
3. AI 서버 실행: `cd AI-main && python app/main.py` (포트 8000)
4. 테스트 계정으로 로그인: example@example.com / testpassword
5. 복지서비스 예약 몇 개 생성 (복지서비스 예약하기 페이지에서)

## 🗣️ 음성 테스트 시나리오

### 시나리오 1: 일반적인 취소 문의
**사용자**: "복지서비스 예약한거 취소할수있어?"
**AI 응답**: 
- 예약 없음: "현재 취소할 수 있는 복지서비스 예약이 없습니다"
- 단일 예약: "6월 1일에 예약된 가정간병 돌봄이 있네요! 이 예약을 취소하시겠어요?"
- 다중 예약: "취소 가능한 예약이 여러 개 있네요! 1. 일상가사 돌봄 6월 1일..."

### 시나리오 2: 구체적인 예약 선택 (번호)
**사용자**: "1번 취소해줘"
**AI 응답**: "6월 1일 일상가사 돌봄 예약이 성공적으로 취소되었습니다!"

### 시나리오 3: 서비스명으로 선택
**사용자**: "가정간병 돌봄 취소해줘"
**AI 응답**: "6월 4일 가정간병 돌봄 예약이 성공적으로 취소되었습니다!"

### 시나리오 4: 날짜로 선택
**사용자**: "6월 1일 예약 취소해줘"
**AI 응답**: "6월 1일 일상가사 돌봄 예약이 성공적으로 취소되었습니다!"

### 시나리오 5: 상대적 날짜
**사용자**: "내일 예약 취소해줘"
**AI 응답**: "내일 예약된 정서지원 돌봄이 성공적으로 취소되었습니다!"

## 💬 텍스트 테스트 시나리오

### 시나리오 1: 다양한 표현 방식
- "예약 취소하고 싶어"
- "복지서비스 취소해주세요"
- "예약한거 취소"
- "예약 철회하고 싶어"

### 시나리오 2: 구체적 선택 방식
- "첫번째 취소해줘"
- "2번째 예약 취소"
- "간병서비스 취소"
- "가사돌봄 취소해주세요"
- "모레 예약 취소"

## 🔍 확인 포인트

### 백엔드 로그 확인
1. `logs/` 폴더에서 로그 파일 확인
2. 콘솔에서 다음 로그 메시지 확인:
   - "🔍 구체적 예약 취소 분석"
   - "🎯 구체적 예약 취소 요청"
   - "📌 번호로 예약 선택" / "🏥 서비스명으로 예약 선택" / "📅 날짜로 예약 선택"

### 프론트엔드 로그 확인
1. 브라우저 개발자 도구 콘솔에서 확인:
   - "🗑️ 복지서비스 예약 취소 응답"
   - "🔄 다중 예약 - 구체적 취소 선택 대기"
   - "🔄 단일 예약 - 취소 확인 대기"

### 실제 데이터베이스 확인
1. 예약 취소 후 `welfare_bookings` 테이블에서 `welfareBookIsCancel = true` 확인
2. 알림 테이블에서 취소 알림 생성 확인

## 🚨 예상 오류 및 해결 방법

### 1. "구체적 예약을 찾을 수 없음" 오류
**원인**: 사용자가 말한 조건과 일치하는 예약이 없음
**해결**: 정확한 서비스명, 날짜, 번호로 다시 시도

### 2. "예약 취소 중 오류가 발생했습니다"
**원인**: 백엔드 WelfareBookService 오류
**해결**: 백엔드 로그 확인 후 서버 재시작

### 3. 음성 인식이 작동하지 않음
**원인**: 브라우저 마이크 권한 없음
**해결**: 브라우저 설정에서 마이크 권한 허용

## 📱 사용자 시나리오 플로우

### 완전한 취소 플로우 예시:
1. **사용자**: "복지서비스 예약 취소하고 싶어"
2. **AI**: "취소 가능한 예약이 여러 개 있네요! 1. 일상가사 돌봄 6월 1일, 2. 가정간병 돌봄 6월 4일..."
3. **사용자**: "가정간병 돌봄 취소해줘"
4. **AI**: "6월 4일 가정간병 돌봄 예약이 성공적으로 취소되었습니다!"

### 단일 예약 취소 플로우:
1. **사용자**: "예약 취소할 수 있어?"
2. **AI**: "6월 1일에 예약된 일상가사 돌봄이 있네요! 이 예약을 취소하시겠어요?"
3. **사용자**: "네 취소해줘"
4. **AI**: "6월 1일 일상가사 돌봄 예약이 성공적으로 취소되었습니다!"

## 🎉 성공 기준
- ✅ 음성으로 "가정간병 취소해줘"라고 말하면 해당 예약이 즉시 취소됨
- ✅ 텍스트로 "1번 취소해주세요"라고 입력하면 첫 번째 예약이 취소됨
- ✅ 날짜로 "내일 예약 취소"라고 하면 내일 예약이 찾아져서 취소됨
- ✅ 모든 취소 과정이 음성 피드백과 함께 자연스럽게 진행됨
- ✅ 취소 완료 후 실제 데이터베이스에서 예약 상태 변경 확인
