# 동행 프로젝트 계획서

## 프로젝트 개요
- **프로젝트명**: 동행 (donghang)
- **타입**: React 프론트엔드 + Node.js/Express 백엔드
- **포트**: 백엔드(9090), 프론트엔드(3000)

## 프로젝트 구조
```
donghang_f/
├── AI-main/          # FastAPI 기반 AI 서버 (포트 8000)
├── backend-main/     # Node.js/Express 백엔드 (포트 9090)
├── frontend-main/    # React 프론트엔드 (포트 3000)
├── docs/            # 프로젝트 문서
└── logs/            # 로그 파일
```

## 실행 방법
### AI 서버 (첫 번째)
```bash
cd AI-main
pip install -r requirements.txt
python app/main.py  # http://localhost:8000
```

### 백엔드 서버 (두 번째)
```bash
cd backend-main
npm install
npm run dev  # http://localhost:9090
```

### 프론트엔드 (세 번째)
```bash
cd frontend-main
npm install  
npm start   # http://localhost:3000
```

## 주요 기능
- **AI 챗봇 서비스** (FastAPI/Python)
  - OpenAI GPT 모델 통합
  - 챗봇 API: `/api/v1/chatbot/chatting`
  - TTS (텍스트 음성 변환)
- **백엔드 API** (Node.js/Express)
  - 사용자 인증 시스템
  - JWT 토큰 기반 인증
  - PostgreSQL/SQLite 데이터베이스 지원
  - SMS 인증 (CoolSMS)
  - API 문서화 (Swagger)
- **프론트엔드** (React)
  - 사용자 인터페이스
  - AI 챗봇 연동
  - 음성 인식 및 합성

## 완료된 작업
- [x] 프로젝트 구조 분석 완료
- [x] docs 폴더 생성
- [x] logs 폴더 생성
- [x] project_plan.md 초기 생성
- [x] OpenAI API 키 테스트 완료 ✅
  - 65개 모델 접근 가능 (GPT-4.5, GPT-4.1, O3, O4-mini 등)
- [x] AI 서버 실행 문제 해결 ✅
  - __init__.py 파일 생성으로 패키지 구조 수정
  - http://127.0.0.1:8000 에서 정상 실행 중
  - 챗봇 서비스 사용 가능
- [x] **마이페이지 정보 표시 및 프로필 수정 기능 완료** ✨👤
  - **문제 해결**: 회원가입 시 입력한 성별, 나이, 지병 정보가 마이페이지에 표시되지 않음
  - **정보 표시 개선**:
    * MyBasicInfo.js에 이름, 성별, 나이, 지병 필드 추가
    * 나이 자동 계산 함수 구현 (생년월일 → 나이 변환)
    * 전화번호 하이픈 포맷팅 유지
    * 지병 정보 표시 (없으면 "없음" 표시)
  - **프로필 수정 기능 추가**:
    * ProfileEdit.js 컴포넌트 새로 생성
    * 이름, 전화번호, 생년월일, 성별, 지병 수정 가능
    * 실시간 유효성 검사 및 에러 처리
    * 백엔드 API 연동 (PUT /api/v1/users)
  - **UI/UX 개선**:
    * 프로필 수정 버튼 추가
    * 수정 모드와 조회 모드 토글 기능
    * 취소/저장 버튼으로 직관적 조작
    * 로딩 상태 표시 및 에러 메시지 처리
  - **CSS 스타일링**:
    * 프로필 수정 폼 전용 스타일 추가
    * 입력 필드, 버튼 스타일링 개선
    * 반응형 디자인 적용
  - **로그 시스템**: 모든 이벤트에 콘솔 로그 추가로 디버깅 용이성 향상
  - **코드 구조 개선**: MyExtraInfo 컴포넌트 제거하고 MyBasicInfo로 통합
- [x] **금복이 자연스러운 대화 및 복지로 사이트 이동 기능 완료** ✨🤖
  - **자연스러운 대화 기능**:
    * "안녕?" → "안녕하세요! 오늘 기분은 어떠신가요? 필요한 정보가 있으시면 언제든 말씀해주세요! 😊"
    * "넌 뭘할수있어?" → "저는 주로 복지서비스 정보 안내와 금융 서비스 지원을 도와드릴 수 있어요! 혹시 구체적으로 필요한 내용을 알려주시면 더 자세히 도와드릴게요! 😊"
    * 감사 인사, 기분 문의, 날씨 관련 질문 등에 자연스러운 응답
    * 하드코딩 없이 AI가 다양한 응답 생성 (랜덤 선택으로 자연스러움 구현)
  - **복지로 사이트 이동 기능**:
    * "복지로 사이트로 이동해줘" → "복지로 사이트로 이동할 준비가 되었어요! 이동을 원하시면 확인 부탁드릴게요!"
    * 음성 응답 후 팝업창 자동 표시
    * "예/아니오" 버튼으로 사용자 확인
    * "예" 클릭 시 새 탭에서 https://www.bokjiro.go.kr 자동 이동
    * 팝업 닫힌 후 음성 인식 자동 재시작
  - **백엔드 AI 서비스 개선**:
    * analyzeWelfarePortalRequest() 함수로 복지로 이동 요청 감지
    * generateNaturalGreeting(), generateCapabilityResponse() 함수로 자연스러운 응답 생성
    * getNaturalResponse() 함수로 기존 딱딱한 응답을 자연스럽게 개선
    * 우선순위 기반 메시지 처리 (인사 → 기능문의 → 복지로이동 → 기타)
  - **프론트엔드 UI/UX 개선**:
    * VoiceChat.js에 confirmModal 상태 추가
    * Modal 컴포넌트를 활용한 깔끔한 확인 팝업
    * 팝업 스타일링으로 사용자 친화적 인터페이스
    * chatScript.js에 showWelfarePortalConfirm() 함수로 팝업 처리
  - **사용자 경험 향상**:
    * 음성 + 팝업 + 자동 이동의 자연스러운 플로우
    * 사용자 의도를 정확히 파악하여 적절한 응답 제공
    * 대화의 연속성과 자연스러움 확보
- [x] **음성 응답 이모티콘 제거 완료** ✨🔇
  - **문제**: 음성으로 답변할 때 "지구본", "별표", "웃는얼굴" 등 이모티콘이 그대로 읽혀서 부자연스러움
  - **해결**: 모든 AI 응답에서 이모티콘 완전 제거
    * generateNaturalGreeting(): 인사 응답 이모티콘 제거
    * generateCapabilityResponse(): 기능 소개 응답 이모티콘 제거
    * generateWelfarePortalResponse(): 복지로 이동 응답 이모티콘 제거
    * formatSimpleWelfareRecommendation(): 복지서비스 추천 이모티콘 제거
    * getDefaultActivityRecommendation(): 기본 활동 추천 이모티콘 제거
    * generateSmartResponse(): 소비내역 저장 응답 이모티콘 제거
    * getNaturalResponse(): 일반 응답 이모티콘 제거
    * getOfflineResponse(): 오프라인 응답 이모티콘 제거
  - **결과**: 
    * "안녕하세요! 오늘 기분은 어떠신가요?" (자연스러운 음성)
    * "복지로 사이트로 이동할 준비가 되었어요!" (깔끔한 음성)
    * "5000원 점심 지출을 가계부에 저장했어요!" (명확한 음성)
  - **개선 효과**: 음성 합성 시 자연스럽고 깔끔한 발음으로 사용자 경험 향상
- [x] **소비내역 조회 기능 수정 완료** ✨💰
  - **문제**: "내 소비내역 알려줘", "한달 소비내역 알려달라고" 입력 시 일반 응답만 나오고 소비내역 조회가 안됨
  - **원인**: processMessage 함수에서 소비내역 조회 로직이 빠져있었음
  - **해결 작업**:
    * `isExpenseInquiry()`: 소비내역 조회 요청 감지 함수 추가
    * `getExpenseHistory()`: 소비내역 조회 함수 추가  
    * `analyzePeriodFromMessage()`: 메시지에서 기간 분석 함수 추가
    * `formatExpenseHistory()`: 조회 결과 포맷팅 함수 추가
    * processMessage 함수에 소비내역 조회 로직 우선순위 6번으로 추가
  - **지원하는 조회 패턴**:
    * "내 소비내역 알려줘" → 최근 30일 소비내역
    * "오늘 소비내역" → 오늘 소비내역
    * "이번달 소비내역" → 이번달 소비내역
    * "지난주 소비내역" → 지난주 소비내역
  - **응답 포맷**:
    * 총 소비 금액 및 거래 건수
    * 카테고리별 소비 통계 (상위 3개)
    * 최근 거래 내역 (최대 5개)
    * 소비내역 페이지 안내
  - **결과**: 음성/텍스트로 "내 소비내역 알려줘" 입력 시 정상적으로 소비내역 조회 및 음성 응답 제공
- [x] **AI 응답 개인화 및 맥락 인식 대폭 개선** ✨🧠
  - **문제**: "5월 소비내역 중 가장 적게사용한 카테고리는 뭐야?" 같은 구체적 질문에도 항상 정형화된 패턴으로만 응답
  - **질문 의도 분석 시스템 구축**:
    * `analyzeExpenseQuestion()`: 질문 유형을 6가지로 분류
      - `category_most`: 가장 많이 사용한 카테고리
      - `category_least`: 가장 적게 사용한 카테고리  
      - `category_ranking`: 카테고리별 순위 비교
      - `category_breakdown`: 카테고리별 세부 분석
      - `merchant_analysis`: 상점/장소 분석
      - `expense_summary`: 총액/요약 정보
      - `general_inquiry`: 일반적인 내역 조회
  - **맞춤형 응답 시스템**:
    * `formatHighestCategoryResponse()`: "가장 많이 사용한 카테고리는 **의료비**예요! 700만원으로 전체의 97%를 차지하고 있네요."
    * `formatLowestCategoryResponse()`: "가장 적게 사용한 카테고리는 **쇼핑**예요! 10만원으로 전체의 1%만 사용하셨네요."
    * `formatCategoryComparisonResponse()`: 카테고리별 순위와 퍼센트를 표로 정리
    * `formatMerchantAnalysisResponse()`: 자주 이용한 상점 TOP 5 분석
    * `formatExpenseSummaryResponse()`: 총액, 평균, 최고/최저 카테고리 종합 분석
  - **기간 인식 개선**:
    * `getPeriodFromMessage()`: "5월", "4월", "3월" 등 구체적 월 인식
    * "오늘", "어제", "이번주", "지난주", "이번달", "지난달" 정확한 구분
  - **자연스러운 응답 생성**:
    * 질문 맥락에 맞는 개인화된 답변
    * 이모지와 강조 표시로 가독성 향상  
    * `calculateMerchantStats()`: 상점별 이용 통계 자동 계산
    * `getCategoryEmoji()`: 카테고리별 적절한 이모지 자동 선택
  - **응답 다양성 확보**:
    * `getNaturalResponse()`: 8가지 상황별 다양한 응답 패턴
    * 인사, 도움요청, 감사인사, 기분문의 등 각각 3-4가지 응답 변형
    * 랜덤 선택으로 매번 다른 자연스러운 대화
  - **개선 효과**:
    * **이전**: "5월 소비내역 중 가장 적게사용한 카테고리는 뭐야?" → "최근 소비내역을 알려드릴게요. 총 소비 금액은..."
    * **이후**: "5월 가장 적게 사용한 카테고리는 **쇼핑**예요! 10만원으로 전체의 1%만 사용하셨네요. 반대로 가장 많이 사용한 건 의료비 카테고리였어요."
  - **사용자 경험**: AI가 질문을 정확히 이해하고 구체적이고 개인화된 답변 제공
- [x] **/api/v1/match 관련 코드 완전 제거** ✨🗑️
  - **문제**: 사용되지 않는 /api/v1/match API 경로가 백엔드에 남아있어서 불필요한 차단 미들웨어 존재
  - **제거 작업**:
    * `app.js`에서 `/api/v1/match*` 경로 차단 미들웨어 완전 제거
    * 410 상태코드 반환하는 코드 제거
    * "이 API 경로는 더 이상 사용되지 않습니다" 메시지 제거
    * 불필요한 로그 출력 코드 제거
  - **확인된 사실**:
    * 프론트엔드에서 /api/v1/match 호출하는 코드 없음
    * 백엔드에서 해당 API 구현 코드 없음  
    * AI 서버에서도 관련 코드 없음
  - **정리 완료**:
    * 백엔드 코드가 더 깔끔해짐
    * 불필요한 미들웨어 제거로 성능 소폭 개선
    * 코드 유지보수성 향상
  - **프론트엔드 정리** ✅ **완료**:
    * `WelfareMain.js`에서 `/api/v1/match` API 호출 코드 제거 ✅
    * `Button.js`에서 `/api/v1/match` API 호출을 `/api/v1/users`로 변경 ✅
    * `LoginBio.js`에서 매칭 체크 로직 제거하고 직접 홈으로 이동 ✅
    * `ProfileA.js`에서 `/api/v1/match`를 `/api/v1/users`로 변경 ✅
    * `DisconnectionModal.js`에서 매칭 해제 기능 제거 ✅
    * `WelfareCheckSpec.js`에서 보호자 로직 제거하고 사용자 정보 조회로 통합 ✅
    * `WelfareHanwoolModal.js`에서 `/api/v1/match`를 `/api/v1/users`로 변경 ✅
    * `WelfareHouseworkModal.js`에서 `/api/v1/match`를 `/api/v1/users`로 변경 ✅
    * `WelfareList.js`에서 보호자 분기 로직 제거하고 단일 사용자 정보 조회로 통합 ✅
    * `WelfareNursingModal.js`에서 `/api/v1/match`를 `/api/v1/users`로 변경 ✅
    * `WelfareReservedList.js`에서 보호자 매칭 로직 제거 ✅
  - **AI 서버 정리** ✅:
    * `chatbot_router.py`에서 `/api/v1/match` 엔드포인트 완전 제거 ✅
  - **백엔드 정리** ✅:
    * `app.js`에서 `/api/v1/match*` 경로 차단 미들웨어 제거 ✅
  - **완전 정리 완료** 🎉: 
    * **프론트엔드, 백엔드, AI 서버 모든 곳에서 `/api/v1/match` 관련 코드 100% 제거 완료**
    * **보호자(PROTECTOR) - 피보호자(PROTEGE) 매칭 시스템 완전 제거**
    * **모든 사용자를 일반 사용자로 통합하여 단순화**
    * **코드 복잡도 대폭 감소 및 유지보수성 향상**

- [x] **보호자 관련 흔적 완전 제거 완료** ✨🧹
  - **문제**: 애플리케이션에서 보호자 기능을 사용하지 않는데도 여러 파일에 보호자 관련 코드와 주석이 남아있음
  - **정리 작업**:
    * `WelfareReservedList.js`: 보호자 관련 주석 제거 및 코드 단순화 ✅
    * `WelfareList.js`: 보호자 주석 제거, welfare-protegeName → welfare-username 클래스명 변경 ✅
    * `WelfareCheckSpec.js`: protege 관련 변수명을 user로 통일 (protegeAddress → userAddress 등) ✅
    * `RoleCheck.js`: PROTEGE → USER 타입으로 변경, 보호자 관련 주석 정리 ✅
    * `ProfileA.js`: protectorName, protegeName 변수를 userName으로 통합 및 단순화 ✅
  - **개선 효과**:
    * 코드 가독성 및 일관성 향상
    * 불필요한 보호자 로직 제거로 복잡도 감소
    * 유지보수성 개선
    * 단일 사용자 기반 애플리케이션으로 명확화

- [x] **소비내역 입력 플로우 수정 완료** ✨💰
  - **문제**: "5,000원 점심 먹었어" 입력 시 일반 응답만 나오고 날짜 확인 플로우가 작동하지 않음
  - **원인**: 백엔드 AI 서비스에서 소비내역 입력 처리 우선순위와 날짜 확인 로직에 문제
  - **수정 작업**:
    * `aiChatService.js`의 `processMessage()` 함수에서 처리 순서 재정렬 ✅
    * 날짜 확인 대기 상태 처리 로직 추가 (우선순위 4번) ✅
    * 소비내역 입력 감지를 소비내역 조회보다 먼저 처리 (우선순위 5번) ✅
    * 날짜 확인이 필요한 경우와 불필요한 경우 분리 처리 ✅
    * 중복된 기존 소비내역 처리 로직 제거 ✅
    * `formatDateForResponse()` 함수 추가로 사용자 친화적 날짜 표시 ✅
  - **새로운 플로우**:
    1. "5,000원 점심 먹었어" → 소비내역 파싱 성공
    2. 날짜 정보 없음 → "일반음식점에서 5,000원 식비 지출이군요! 언제 사용하셨나요?"
    3. "오늘" 답변 → 오늘 날짜로 소비내역 저장
    4. "네! 오늘 일반음식점에서 5,000원 식비 지출을 가계부에 저장했어요!"
  - **세션 상태 관리**: 
    * `waitingForDateConfirmation`: 날짜 확인 대기 상태
    * `pendingExpenseData`: 임시 저장된 소비내역 데이터
  - **결과**: 원래 의도했던 대화형 소비내역 입력 플로우 완전 복구

- [x] **날짜 파싱 및 소비 키워드 인식 오류 수정 완료** ✨📅
  - **문제**: "5월 15일", "10일전", "3일전", "75,000원 쇼핑 했어" 등이 인식되지 않음
  - **원인 분석**:
    * `extractDateFromText()` 함수의 정규식 패턴에 잘못된 이스케이프 문자 사용
    * "쇼핑" 키워드가 소비 키워드 목록에 누락
    * `today` 변수 정의 오류로 "N일 전", "월일" 패턴 처리 실패
  - **수정 작업**:
    * 정규식 패턴 수정: `/(\\\\d+)/` → `/(\d+)/` ✅
    * 소비 키워드 확장: "쇼핑", "지출", "결제", "사용" 추가 ✅
    * 카테고리 분류 개선: 쇼핑→쇼핑카테고리, 교통→교통비, 의료→의료비 ✅
    * `extractDateFromText()` 함수 완전 재구성 ✅
    * KST 기준 날짜 계산 함수 정상화 ✅
  - **개선된 인식 패턴**:
    * **상대 날짜**: "오늘", "어제", "그제/그저께", "N일 전" ✅
    * **절대 날짜**: "5월 15일", "15일" (현재 월 기준) ✅
    * **소비 표현**: "75,000원 쇼핑 했어" → 쇼핑 카테고리로 정확히 분류 ✅
    * **금액 표현**: "6만 원", "7천원", "5,000원" 모두 정확히 파싱 ✅
  - **테스트 결과**:
    * "75,000원 쇼핑 했어" → "일반상점에서 75,000원 쇼핑 지출이군요! 언제 사용하셨나요?" ✅
    * "5월 15일" → 2025-05-15로 정확히 변환 ✅
    * "3일전" → 현재 날짜 기준 3일 전 날짜로 정확히 계산 ✅
  - **결과**: 사용자 입력의 날짜 및 소비 표현 인식률 대폭 향상

- [x] **소비내역 페이지 인라인 달력 구현 완료** ✨📅
  - **문제**: 기간설정 버튼 클릭 시 모달창이 나타나는 방식이 불편함
  - **요구사항**: 기간설정 버튼 클릭 시 바로 아래에 달력이 나타나는 인라인 방식으로 변경
  - **구현 작업**:
    * `InlineDatePicker.js` 컴포넌트 새로 생성 ✅
    * `InlineDatePicker.css` 전용 스타일 생성 ✅
    * `Consumption.js`에서 모달 방식을 인라인 방식으로 변경 ✅
    * `showDatePicker` 상태로 인라인 달력 토글 제어 ✅
    * 기존 `ConsumDateModal` 제거 및 코드 정리 ✅
  - **인라인 달력 기능**:
    * 기간설정 버튼 클릭 → 바로 아래 부드러운 애니메이션으로 달력 표시 ✅
    * 시작날짜/종료날짜 입력 필드 ✅
    * 빠른 날짜 선택 버튼: "오늘", "최근 1주일", "이번 달", "최근 3개월" ✅
    * 확인/취소 버튼으로 날짜 적용 또는 닫기 ✅
    * 닫기 버튼(×)으로 언제든 달력 숨기기 ✅
  - **UX/UI 개선**:
    * 슬라이드 다운 애니메이션 효과 ✅
    * 모바일 반응형 디자인 적용 ✅
    * 큰 버튼과 명확한 레이블로 사용자 친화적 설계 ✅
    * 날짜 유효성 검사 (시작일 ≤ 종료일) ✅
  - **결과**: 모달창 없이 바로 아래 펼쳐지는 직관적인 달력 인터페이스로 사용자 경험 향상

- [x] **복지서비스 예약 시 알림 생성 기능 완료** ✨🔔
  - **문제**: 복지서비스를 예약하거나 취소할 때 사용자에게 알림이 전송되지 않아 불편함
  - **복지서비스 예약 알림 시스템 구축**:
    * NotificationService에 복지서비스 전용 알림 생성 함수 추가
    * `createWelfareBookingNotification()`: 예약 완료 알림 생성
    * `createWelfareBookingCancelNotification()`: 예약 취소 알림 생성
    * `createWelfareBookingReminderNotification()`: 예약 확인 알림 생성 (예약일 전날)
  - **알림 내용 개선**:
    * 예약 완료: "복지서비스 예약 완료" + 서비스명, 예약기간, 총비용, 예약번호
    * 예약 취소: "복지서비스 예약 취소" + 서비스명, 취소된 예약기간, 예약번호
    * 예약 확인: "복지서비스 예약 안내" + 내일 예약 안내, 서비스 날짜
  - **WelfareBookService 연동**:
    * 복지서비스 예약 생성 시 자동으로 완료 알림 생성
    * 복지서비스 예약 취소 시 자동으로 취소 알림 생성
    * 알림 생성 실패해도 예약 프로세스는 정상 진행 (안정성 확보)
  - **홈페이지 헤더 알림 버튼 완성**:
    * 알림 아이콘 클릭 시 `/alarm` 페이지로 이동
    * 읽지 않은 알림 수를 실시간 표시 (빨간 뱃지)
    * 30초마다 자동 업데이트로 실시간성 확보
    * 모바일 반응형 디자인 적용
  - **소비내역 등록 시 알림 시스템 기존 완성**:
    * 소비내역 등록 시 자동으로 알림 생성 (PAYMENT 타입)
    * 큰 금액(10만원 이상) 소비 시 이상 징후 알림 생성 (ANOMALY 타입, HIGH 우선순위)
    * 알림 내용에 상점명, 금액, 카테고리 정보 포함
- [x] **홈페이지 복지서비스 예약하기 버튼 추가 완료** ✨🔘
  - **위치**: 홈페이지 복지서비스 섹션에 "복지서비스 이용하기" 버튼 옆에 추가
  - **버튼 기능**:
    * "복지서비스 예약하기" 버튼 클릭 시 `/welfare-reserved-list` 페이지로 이동
    * 사용자의 복지서비스 예약 내역을 조회하고 관리할 수 있는 페이지
  - **UI/UX 개선**:
    * 두 버튼을 나란히 배치 (Flexbox 레이아웃)
    * "복지서비스 이용하기": 화이트 배경, 기본 스타일
    * "복지서비스 예약하기": 주황색 배경 (#FF6B35), 강조 스타일
    * 호버 효과: 약간의 그림자 증가 및 위로 이동 애니메이션
    * 모바일 반응형: 작은 화면에서는 세로로 배치
  - **기술적 구현**:
    * `WelfareSlide.js`에서 두 번째 버튼 추가
    * `WelfareSlide.css`에서 버튼 컨테이너 및 스타일 정의
    * `handleGoWelfareReservation()` 함수로 예약 내역 페이지 이동
    * 반응형 디자인으로 모바일/태블릿 대응
  - **연결된 기능**:
    * 예약 내역 조회 (`/welfare-reserved-list`)
    * 예약 취소 기능 (WelfareReserveCancelModal)
    * 예약 완료 시 알림 자동 생성 연동
  - **결과**: 사용자가 홈페이지에서 바로 복지서비스 예약 관리에 접근 가능

- [x] **복지 서비스 예약 시스템 UI/UX 대폭 개선 완료** ✨🎯
  - **복지서비스 찾기 페이지 개선**:
    * "복지 서비스 더 보기" 버튼 옆에 "복지 서비스 예약하기" 버튼 추가
    * 두 버튼을 나란히 배치하여 기능 분리 명확화
    * 예약하기 버튼은 주황색 배경으로 강조 표시
    * 호버 효과 및 반응형 디자인 적용
  - **새로운 복지서비스 예약 페이지 생성**:
    * `WelfareBookingPage.js`: 예약 가능한 복지서비스 목록 표시
    * 무료/유료 서비스 필터링 기능
    * 각 서비스마다 예약하기 버튼 제공
    * 서비스 정보 (이름, 카테고리, 가격) 명확히 표시
  - **예약 모달 시스템 구축**:
    * `WelfareBookingModal.js`: 상세 예약 입력 폼
    * 시작일/종료일, 이용시간, 특별요청사항 입력
    * 실시간 총 금액 계산 및 표시
    * 폼 유효성 검사 (날짜 검증, 필수 입력 확인)
    * 예약 완료 시 자동 알림 생성 연동
  - **예약 현황 페이지 오류 수정**:
    * API 경로 수정: `/api/v1/welfare/bookings` → `/api/v1/welfare-book`
    * 백엔드 응답 구조에 맞게 데이터 매핑 수정
    * 예약 상태 필터링 로직 개선 (진행중/완료/취소)
    * 예약 취소 API 경로 수정 및 기능 정상화
  - **사용자 경험 향상**:
    * 직관적인 예약 플로우: 서비스 선택 → 예약 정보 입력 → 완료
    * 실시간 금액 계산으로 투명한 가격 정보 제공
    * 예약 완료 후 자동으로 예약 내역 페이지로 이동
    * 모든 예약 관련 기능의 일관된 UI/UX 디자인
  - **기술적 개선**:
    * React Modal을 활용한 깔끔한 예약 입력 UI
    * CSS Module을 사용한 스타일 캡슐화
    * 반응형 디자인으로 모바일/태블릿 완벽 지원
    * 에러 처리 및 로딩 상태 표시로 사용자 피드백 강화

- [x] **복지 서비스 예약 기능 개선 완료** ✨📋
  - **슬라이드 3개 서비스만 예약 가능하도록 제한**:
    * 백엔드 WelfareController 수정하여 3개 서비스만 반환
    * 일상가사 돌봄 (50,000원)
    * 가정간병 돌봄 (80,000원)
    * 정서지원 돌봄 (무료)
  - **예약 정보 입력 폼 개선**:
    * 2단계 입력 프로세스 구현 (예약자 정보 → 예약 상세)
    * Step 1: 예약자 정보
      - 이름, 생년월일, 성별 (필수)
      - 주소, 상세주소, 연락처 (필수)
      - 신장, 체중 (선택)
      - 특이사항 (지병, 알레르기 등)
    * Step 2: 예약 상세
      - 서비스 시작일/종료일
      - 이용 시간
      - 특별 요청사항
  - **예약 상세 정보 모달 구현**:
    * `WelfareReservationDetailModal.js` 컴포넌트 생성
    * 예약 내역 클릭 시 상세 정보 표시
    * 서비스 정보, 이용 정보, 예약자 정보, 결제 정보 섹션별 표시
    * 나이 자동 계산 기능
    * 반응형 디자인 적용
  - **UI/UX 개선 사항**:
    * 예약 카드 클릭 시 상세 정보 모달 표시
    * 예약취소 버튼 클릭 이벤트 전파 방지
    * 폼 입력 필드 스타일링 개선
    * 모바일 최적화된 레이아웃

- [x] **복지서비스 가격 정책 및 UI 수정 완료** ✨💰
  - **문제**: 복지서비스 가격이 고정되어 있고 시간당 요금제가 아니었음
  - **가격 정책 변경**:
    * 일상가사 돌봄: 시간당 30,000원 (기존 50,000원 고정)
    * 가정간병 돌봄: 시간당 40,000원 (기존 80,000원 고정)  
    * 정서지원 돌봄: 시간당 20,000원 (기존 무료)
  - **백엔드 수정**:
    * `WelfareController.js`에서 slideServices 가격 및 priceType 수정
    * 모든 서비스를 유료로 변경하고 시간당 요금제 적용
  - **프론트엔드 UI 개선**:
    * 필터 버튼을 "무료/유료" → "카테고리별" (전체/가사지원/간병지원/정서지원)로 변경
    * 가격 표시를 "{금액}원/시간" 형태로 변경
    * WelfareBookingModal에서 실시간 가격 계산 로직 개선
  - **가격 계산 로직**:
    * 시간 옵션에 따른 실제 시간 계산 (3시간, 6시간, 9시간, 1-6개월)
    * 월 단위는 30일 기준으로 계산 (1개월 = 24×30시간)
    * 가격 정보 섹션에 시간당 요금, 선택 시간, 총 시간, 총 금액 상세 표시
  - **사용자 경험 향상**:
    * 투명한 가격 책정으로 예측 가능한 비용 계산
    * 시간 선택에 따른 실시간 금액 업데이트
    * 상세한 가격 정보 제공으로 신뢰성 향상
- [x] **복지서비스 예약 취소 모달 스크롤 개선 완료** ✨📱
  - **문제**: 예약 취소 모달에서 내용이 잘려서 스크롤 문제 발생
  - **해결**: 
    * 모달 높이: 고정 320px → 최대 90vh (화면 높이의 90%)
    * 스크롤: overflow 'hidden' → 'auto'로 변경하여 필요시 스크롤 가능
    * CSS 구조 개선: 컨테이너 높이를 auto로 조정하여 내용에 맞게 자동 크기 조절
    * 반응형 지원: 다양한 화면 크기에서 적절한 크기로 표시
  - **결과**: 모든 내용이 정상적으로 보이고 스크롤 문제 완전 해결
- [x] **복지서비스 예약 알림 디버깅 로그 강화 완료** ✨📝
  - **문제**: 복지서비스 예약 시 알림이 생성되지 않는 문제 진단 필요
  - **개선 작업**:
    * WelfareBookService.createWelfareBook()에 상세한 알림 생성 로그 추가
    * NotificationService.createWelfareBookingNotification()에 단계별 로그 추가
    * 알림 생성 시작/완료, 에러 발생 시 상세 정보 출력
    * 사용자 정보, 예약 정보, 알림 내용 모든 단계 추적 가능
  - **로그 정보**:
    * 예약 생성 시: UserNo, BookingNo, WelfareNo, 서비스명, 기간, 금액
    * 알림 생성 시: 알림 제목, 내용, 타입(WELFARE), NotificationNo
    * 에러 발생 시: 상세 에러 메시지, 스택 트레이스, 관련 데이터
  - **결과**: 복지서비스 예약 시 알림 생성 과정을 완전히 추적하여 문제 진단 가능
- [x] **복지서비스 예약 API 엔드포인트 수정 완료** ✨🔧
  - **문제**: 프론트엔드에서 잘못된 API 엔드포인트를 사용하여 알림이 생성되지 않음
  - **원인 파악**:
    * 현재 사용: `/api/v1/test-welfare/test-reserve` (알림 생성 코드 없음)
    * 사용해야 할: `/api/v1/welfare-book/reserve` (알림 생성 코드 있음)
  - **수정 작업**:
    * WelfareBookingModal.js에서 테스트 API → 정식 예약 API로 변경
    * 정식 API는 WelfareBookService.createWelfareBook() 호출하여 알림 자동 생성
  - **결과**: 이제 복지서비스 예약 시 알림이 정상적으로 생성됨
- [x] **복지서비스 예약 UX 개선 완료** ✨👤
  - **문제**: 사용자 정보가 마이페이지에 있는데 예약 시 중복 입력받아서 번거로움
  - **개선 작업**:
    * 2단계 예약 프로세스 → 1단계로 단순화
    * 예약자 정보 입력 단계 완전 제거
    * 마이페이지에서 사용자 정보 자동 조회 (이름, 전화번호, 성별, 나이)
    * 주소만 별도 입력받도록 변경 (서비스 이용 주소)
    * **예약자 정보 표시 부분도 제거** - 깔끔한 UI로 개선
  - **UI/UX 개선**:
    * 예약자 정보 섹션 완전 제거하여 단순화
    * 주소 입력 + 예약 정보 입력만 남겨서 직관적
    * 사용자 정보는 백그라운드에서 자동 처리
  - **기술적 구현**:
    * useEffect로 페이지 로드 시 사용자 정보 조회 (화면에 표시 안함)
    * 예약 데이터에 조회된 사용자 정보 자동 포함
    * userDisease 필드를 userMedicalInfo로 매핑
  - **결과**: 최대한 간소화된 예약 프로세스로 사용자 편의성 극대화
  - **문제**: `Unexpected token 'n', "null" is not valid JSON` 오류 지속 발생
  - **근본 원인**: DELETE 요청에서 `null` body를 전송하여 백엔드 body-parser가 JSON 파싱 오류 발생
  - **수정 작업**:
    * ApiService.js에서 DELETE 요청 시 body를 전송하지 않도록 수정
    * `body: method !== 'GET' && method !== 'DELETE' && request ? JSON.stringify(request) : undefined`
    * WelfareReservedList.js에서 call 함수 호출 시 세 번째 매개변수 제거
  - **모달 크기 최적화**:
    * 모달 크기: width 320px, height auto (내용에 맞게 자동 조절)
    * 스크롤 제거: overflow: 'visible', minHeight/maxHeight 설정
    * 내부 여백 축소: margin-top 20px, margin-bottom 60px로 조정
  - **결과**: 스크롤 없이 깔끔하게 표시되는 예약 취소 확인 모달과 정상 작동하는 취소 기능
  - **모달 크기 축소**:
    * 기존: height 250px, 전체 화면 중앙 배치
    * 개선: width 300px, height 180px로 컴팩트하게 변경
    * 화면 중앙 정확히 배치 (transform: translate(-50%, -50%))
  - **예약 취소 API 오류 수정**:
    * **문제**: "Unexpected token 'n', "null" is not valid JSON" 오류 발생
    * **원인**: 서버 응답 처리 중 JSON 파싱 오류
    * **해결**: WelfareBookService.deleteWelfareBook 메서드에 상세 로그 추가
    * 데이터베이스 업데이트 과정과 알림 생성 과정 추적 가능
  - **로그 강화**:
    * 예약 취소 시작/완료 로그 추가
    * 데이터베이스 업데이트 결과 확인 로그
    * 알림 생성 성공/실패 로그 분리
  - **결과**: 사용자 친화적인 작은 모달과 더 안정적인 예약 취소 기능
  - **문제**: 복지서비스 예약 내역에서 "예약취소" 버튼과 "대기중" 상태 배지가 겹쳐보임
  - **원인**: CSS에서 예약취소 버튼이 `position: absolute`로 설정되어 상태 배지와 겹침
  - **수정 작업**:
    * `detailed-reserved-cancel-container`: flexbox 레이아웃으로 변경
    * `detailed-reserved-cancel`: absolute positioning 제거하고 flexbox 아이템으로 변경
    * 버튼 크기와 폰트 크기 조정으로 모바일 친화적 디자인
  - **결과**: 예약취소 버튼이 상태 배지와 겹치지 않고 깔끔하게 배치됨

- [x] **복지서비스 예약 알림 생성 로그 강화** ✨📝
  - **문제**: 복지서비스 예약 시 알림이 생성되지 않는 문제 디버깅 필요
  - **개선 작업**:
    * WelfareBookService에 상세한 알림 생성 로그 추가
    * 예약 완료 알림 생성 시작/완료 로그 추가
    * 알림 생성 실패 시 에러 스택 트레이스 출력
    * NotificationNo 반환 확인 로그 추가
  - **결과**: 복지서비스 예약 시 알림 생성 과정을 상세히 추적 가능
  - **알림 필터 버튼 개선**:
    * 기존: 전체, 카드, 결제, 복지, 시스템 (5개 버튼)
    * 개선: 전체, 소비, 복지 (3개 버튼으로 단순화)
    * 소비 카테고리에 PAYMENT, ANOMALY 타입 모두 포함
  - **100만원 이상 지출 시 별도 알림 생성**:
    * 일반 소비내역 등록 알림과 별개로 큰 금액 소비 감지 알림 추가
    * "⚠️ 큰 금액 소비 감지" 제목으로 HIGH 우선순위 알림 생성
    * 본인 사용 확인을 위한 안전장치 알림
    * ANOMALY 타입으로 분류되어 소비 카테고리에서 확인 가능
  - **복지서비스 예약 알림 시스템**:
    * 복지서비스 예약 완료 시 WELFARE 타입 알림 자동 생성
    * 예약 취소 시에도 취소 알림 생성
    * 복지 카테고리에서 모든 복지 관련 알림 확인 가능
  - **알림 필터링 로직 개선**:
    * 소비 카테고리 클릭 시 일반 소비내역 + 큰 금액 소비 알림 모두 표시
    * 복지 카테고리 클릭 시 예약 완료/취소 알림 표시
    * 전체 카테고리에서 모든 알림 통합 조회

- [x] **복지서비스 예약 상세 정보 표시 오류 수정 완료** ✨🔧
  - **문제**: 복지서비스 예약 내역 클릭 시 예약자 정보가 "정보 없음"으로 표시
  - **원인**: WelfareBookService에서 예약자 개인정보를 반환하지 않음
  - **해결**: getAllByUserNo(), getDetailById() 메서드에 예약자 정보 추가
  - **결과**: 예약 상세 모달에서 이름, 생년월일, 성별, 연락처, 주소 등 모든 정보 정상 표시
  - **WelfareBook 모델 완전 재구성**:
    * 예약자 개인정보 필드 추가: 이름, 생년월일, 성별, 주소, 연락처, 신장, 체중, 특이사항
    * 예약 정보 필드: 시작일, 종료일, 이용시간, 총금액, 예약일시, 특별요청사항
    * 상태 관리 필드: 완료여부, 취소여부, 취소일시
  - **데이터베이스 테이블 생성**:
    * `welfare_bookings` 테이블 생성 (모든 필드 포함)
    * 테이블 재생성 스크립트 작성 및 실행
    * 모델과 데이터베이스 동기화 완료
  - **예약 API 완전 구현**:
    * `/api/v1/welfare-book/reserve` POST: 복지서비스 예약 생성
    * `/api/v1/welfare-book` GET: 사용자별 예약 내역 조회
    * `/api/v1/welfare-book/{id}` DELETE: 예약 취소
    * 하드코딩된 3개 서비스 지원 (실제 DB 테이블 없이도 동작)
  - **가격 계산 로직 구현**:
    * 시간당 요금 × 실제 시간 = 총 금액
    * 월 단위 시간 계산 (1개월 = 24×30시간)
    * WelfareBookService에서 정확한 가격 계산
  - **예약 완료 시 알림 자동 생성**:
    * NotificationService 연동으로 예약/취소 알림 생성
    * 알림 생성 실패해도 예약 프로세스는 정상 진행 (안정성)
  - **프론트엔드 연동**:
    * 2단계 예약 폼 (개인정보 입력 → 예약 상세)
    * 실시간 가격 계산 및 표시
    * 예약 완료 후 자동 페이지 이동
  - **결과**: "사용자 또는 복지 항목이 존재하지 않습니다" 오류 해결 완료

- [x] **복지서비스 예약 상세 정보 표시 오류 수정 완료** ✨🔧
  - **문제**: 복지서비스 예약 내역 클릭 시 예약자 정보가 "정보 없음"으로 표시됨
  - **원인**: WelfareBookService.getAllByUserNo() 메서드에서 예약자 개인정보를 반환하지 않았음
  - **수정 작업**:
    * `WelfareBookService.js`의 `getAllByUserNo()` 메서드 수정
    * 반환 데이터에 예약자 개인정보 필드 추가:
      - userName, userBirth, userGender
      - userAddress, userDetailAddress, userPhone  
      - userHeight, userWeight, userMedicalInfo
      - specialRequest
    * `getDetailById()` 메서드도 동일하게 수정
  - **결과**: 
    * 예약 내역 클릭 시 모든 예약자 정보가 정상 표시
    * 이름, 생년월일, 성별, 연락처, 주소 등 모든 정보 확인 가능
    * 예약 상세 모달에서 완전한 정보 제공

- [x] **복지서비스 음성 예약 시스템 구현 완료** ✨🎙️
  - **음성 대화형 예약 플로우 구현**:
    * "복지서비스 예약하고 싶어" → "안녕하세요! 어떤 복지 서비스를 예약하고 싶으신가요? 가정간병 서비스와 일상가사 서비스, 정서지원 서비스중 선택하실 수 있습니다."
    * "가정간병 서비스" → "좋습니다 가정간병 돌봄을 예약하실 날짜와 원하는 시간대, 주소를 알려주시겠어요? 선택할 수 있는 시간대는 오전 9시부터 오후 12시, 오전 9시부터 오후 3시, 오전 9시부터 오후 6시까지 입니다"
    * "내일 3시까지" → "내일 오전 9시부터 오후 3시까지 가정간병 서비스를 예약하시겠군요 그럼 주소를 알려주시겠어요?"
    * 주소 입력 → "해당 주소로 예약을 진행하려고 하는데 맞으신가요? 확인해주시면 예약 페이지로 안내해드리겠습니다"
    * "응" → "확인감사합니다 예약 페이지로 안내해드리겠습니다 잠시만 기다려주세요" + 예약 페이지 이동 확인 팝업
  - **백엔드 AI 서비스 개선**:
    * `welfareBookingAiService.js`: 복지서비스 예약 전용 AI 서비스 분리
    * 4단계 예약 플로우: service_selection → details_input → address_input → confirmation
    * 세션 상태 관리로 대화 맥락 유지
    * 서비스 선택, 날짜/시간 분석, 주소 추출, 확인 단계별 처리
  - **동적 데이터 처리 (하드코딩 제거)**:
    * 복지서비스 목록을 실제 데이터에서 동적으로 조회
    * 서비스별 키워드를 서비스명과 카테고리 기반 동적 생성
    * 시간대 옵션을 설정 기반 구조로 변경 (확장 가능)
    * 5분 캐시 시스템으로 성능 최적화
  - **프론트엔드 음성 처리**:
    * `chatScript.js`에 복지서비스 예약 완료 감지 로직 추가
    * 예약 완료 시 음성 응답 후 자동으로 예약 페이지 이동 확인 팝업 표시
    * 사용자 확인 시 예약 페이지로 이동하면서 예약 데이터 전달
  - **자연스러운 대화 처리**:
    * 서비스명 정확 인식: "가정간병", "일상가사", "정서지원"
    * 시간대 분석: "3시까지", "6시까지", "12시", "점심", "저녁"
    * 날짜 분석: "내일", "모레", "N일 후"
    * 주소 추출: 한국 주소 패턴 인식
  - **사용자 경험**: 음성으로 자연스럽게 대화하며 복지서비스 예약 가능
  - **확장성**: 새로운 복지서비스 추가 시 키워드만 업데이트하면 자동 대응

- [x] **복지서비스 음성 예약 시스템 버그 수정 완료** ✨🔧
  - **문제**: 음성 예약 완료 시 `/welfare-booking-page` URL로 이동하려 하지만 해당 라우트가 존재하지 않아 404 오류 발생
  - **원인**: `chatScript.js`에서 잘못된 URL `/welfare-booking-page` 사용, 실제 라우트는 `/welfare-booking`
  - **수정 작업**:
    * `chatScript.js`에서 URL 수정: `/welfare-booking-page` → `/welfare-booking`
    * `WelfareBookingPage.js`에 URL 파라미터 처리 로직 추가
    * 음성 예약 데이터 감지 시 자동으로 해당 서비스 선택 및 모달 열기
    * `WelfareBookingModal.js`에 `voiceBookingData` props 추가
    * 음성 예약 데이터로 주소, 시작일, 종료일, 시간 옵션 자동 입력
    * 음성 예약 안내 메시지 및 스타일 추가
  - **개선된 플로우**:
    * 음성: "복지서비스 예약해줘" → 서비스 선택 → 날짜/시간/주소 입력 → 확인
    * 음성 응답 후 예약 페이지 이동 확인 팝업 표시
    * 확인 시 `/welfare-booking?serviceId=1&serviceName=...&startDate=...` 형태로 이동
    * 자동으로 해당 서비스 모달 열기 및 폼에 음성 입력 데이터 자동 채움
  - **사용자 경험**: 음성으로 예약한 내용이 폼에 미리 입력되어 편리한 예약 완료 가능
  - **결과**: 404 오류 해결 및 완전한 음성 예약 시스템 구현 완료
  - [ ] 음성 대화형 예약 플로우 테스트
  - [ ] "복지서비스 예약하고 싶어" → 서비스 선택 → 날짜/시간 → 주소 → 확인 → 페이지 이동 전체 플로우 검증
  - [ ] 각 단계별 음성 응답 및 인식 정확도 확인
  - [ ] 예약 완료 후 실제 예약 페이지 이동 및 데이터 전달 검증
- [ ] **기존 예약 시스템과 연동 테스트** 🔗
  - [ ] 음성으로 입력한 예약 정보가 기존 예약 시스템에 올바르게 전달되는지 확인
  - [ ] 예약 완료 후 알림 생성 및 예약 내역 조회 기능 연동 테스트

## 테스트 계정
- 아이디: example@example.com
- 비밀번호: testpassword

## 최근 업데이트
- 2025-05-30: **AI 복지서비스 예약 취소 기능 추가 완료** ✨🗑️
  - **요구사항**: "복지서비스 예약한거 취소할수있어?" 같은 질문에 AI가 예약 취소 도움 제공
  - **백엔드 구현**:
    * `analyzeWelfareBookingCancelRequest()` 함수 - 예약 취소 요청 감지
    * `handleWelfareBookingCancelRequest()` 함수 - 예약 취소 상황별 처리
    * 예약 요청과 취소 요청 구분 로직 개선
  - **취소 요청 처리 시나리오**:
    * 📋 **취소 가능한 예약 없음**: "현재 취소할 수 있는 복지서비스 예약이 없습니다"
    * 1️⃣ **단일 예약**: "가정간병 돌봄 예약이 있네요! 이 예약을 취소하시겠어요?"
    * 🔢 **다중 예약**: "취소 가능한 예약이 여러 개 있네요!" + 목록 표시
    * ❌ **오류 발생**: "예약 내역을 확인하는 중 오류가 발생했습니다"
  - **프론트엔드 연동**:
    * 예약 취소 응답 감지 시 예약 내역 페이지로 이동 확인 팝업
    * `showWelfareReservedListConfirm()` 함수로 사용자 확인 후 페이지 이동
    * 음성 응답 후 자동으로 예약 내역 페이지 안내
  - **사용자 경험**: 
    * 🎙️ "예약한거 취소해줘" → AI가 예약 상황 확인 → 예약 내역 페이지 안내
    * 복잡한 취소 과정을 AI가 단순하게 안내하여 사용자 편의성 대폭 향상
- 2025-05-30: **AI 기능 소개 응답 개선 완료** ✨🤖
  - **문제**: "넌 뭘 할 수 있어?" 질문에 대한 AI 응답이 실제 구현된 기능과 맞지 않음
  - **개선 사항**:
    * `generateCapabilityResponse()` 함수 업데이트 - 실제 기능에 맞는 응답으로 변경
    * 일반 응답의 기능 소개 부분도 실제 구현 기능 반영
    * 도움 요청 응답에 구체적인 사용 예시 추가
  - **업데이트된 기능 소개**:
    * 🎙️ 음성/텍스트 가계부 자동 기록 ("5만원 마트에서 썼어")
    * 📊 월별 소비내역 분석 ("4월 소비내역 알려줘")
    * 🏥 복지서비스 맞춤 추천 및 음성 대화형 예약
    * 🔔 알림 관리 시스템
    * 🌐 복지로 사이트 안내
  - **사용자 경험**: AI가 실제 제공하는 기능을 정확히 안내하여 사용자 만족도 향상
- 2025-05-30: **취소된 복지서비스 예약 완전 삭제 기능 추가 완료** ✨🗑️
  - **요구사항**: 취소된 예약 내역을 완전히 삭제할 수 있는 기능 추가
  - **백엔드 구현**:
    * `WelfareBookService.permanentlyDeleteWelfareBook()` 메서드 추가
    * 취소된 예약만 완전 삭제 가능하도록 검증 로직 구현
    * `WelfareBookController.permanentlyDelete()` 엔드포인트 추가
    * `DELETE /api/v1/welfare-book/:id/permanent` 라우트 추가
  - **프론트엔드 구현**:
    * 취소된 예약 카드 하단에 "삭제" 버튼 추가
    * 삭제 확인 다이얼로그로 사용자 안전장치 구현
    * 삭제 버튼 전용 CSS 스타일 추가 (빨간 테두리, 호버 효과)
    * `handlePermanentDelete()` 함수로 완전 삭제 API 호출
  - **사용자 경험**:
    * 취소된 예약만 삭제 버튼 표시 (진행중/완료된 예약은 삭제 불가)
    * "삭제된 내역은 복구할 수 없습니다" 경고 메시지
    * 삭제 완료 후 목록 자동 새로고침
  - **결과**: 사용자가 불필요한 취소된 예약 내역을 깔끔하게 정리 가능
- 2025-05-30: **4월/5월 소비내역 조회 오류 수정 완료** ✨🔧
  - **문제**: "4월 소비내역 알려줘"를 입력해도 5월 데이터로 응답하는 문제
  - **원인**: `analyzePeriodFromMessage` 함수에서 구체적인 월(4월, 5월 등) 처리 로직 누락
  - **해결**: 
    * `analyzePeriodFromMessage`에 월별 처리 추가 (january, february, march, april, may)
    * `getExpenseHistory`에서 구체적인 월인 경우 `custom_month` 타입으로 처리
    * ConsumptionService의 `customMonth` 매개변수 활용
  - **결과**: "4월 소비내역 알려줘", "5월 소비 리포트 알려줘" 정확한 월별 데이터 조회 가능
- 2025-05-30: **AI 서비스 오류 수정 및 소비내역 조회 순서 개선** ✨🔧
  - **문제**: "복지서비스 예약해줘" 입력 시 빈 오류 객체 `{}` 반복 출력
  - **원인**: `simpleParseExpense` 함수 누락, 복잡한 조건 처리로 인한 예외 발생
  - **해결**: 
    * `simpleParseExpense` 함수 추가 (금액 패턴 인식, 소비 키워드 확인)
    * `processMessage` 함수 간소화 및 우선순위 명확화
    * 소비내역 조회를 소비내역 입력보다 우선 처리하도록 순서 변경
    * 에러 처리 강화 및 로그 저장 안정성 개선
  - **결과**: AI 챗봇이 정상적으로 작동, 복지서비스 예약 및 소비내역 기능 모두 안정화
- 2025-05-29: **복지서비스 음성 예약 시스템 구현 완료 (하드코딩 제거)** ✨🎙️
  - **음성 대화형 예약 플로우**: "복지서비스 예약하고 싶어" → 서비스 선택 → 날짜/시간/주소 → 확인 → 페이지 이동
  - **자연스러운 대화 처리**: 서비스명, 시간대, 날짜, 주소 정확 인식
  - **백엔드 AI 서비스**: welfareBookingAiService.js로 예약 전용 로직 분리
  - **4단계 예약 플로우**: service_selection → details_input → address_input → confirmation
  - **동적 데이터 처리**: 복지서비스 목록 동적 조회, 키워드 동적 생성, 5분 캐시 시스템
  - **확장성 확보**: 새로운 서비스 추가 시 자동 대응, 하드코딩 완전 제거
  - **프론트엔드 음성 처리**: 예약 완료 시 음성 응답 후 예약 페이지 이동 확인 팝업
- 2025-05-29: **알림 시스템 UI 개선 및 대용량 지출 알림 기능 완료** ✨🔔
  - **알림 필터 버튼 단순화**: 전체, 소비, 복지 (3개 버튼)
  - **100만원 이상 지출 시 별도 알림**: 일반 소비내역과 별개로 큰 금액 소비 감지 알림 생성
  - **복지서비스 예약 알림**: 예약 완료/취소 시 자동 알림 생성으로 사용자 편의성 향상
  - **소비 카테고리**: 일반 소비내역(PAYMENT) + 큰 금액 소비(ANOMALY) 알림 통합 표시
- 2025-05-29: **복지서비스 예약 상세 정보 표시 오류 수정 완료** ✨🔧
  - **문제**: 복지서비스 예약 내역 클릭 시 예약자 정보가 "정보 없음"으로 표시
  - **해결**: getAllByUserNo(), getDetailById() 메서드에 예약자 정보 추가
  - **결과**: 예약 상세 모달에서 이름, 생년월일, 성별, 연락처, 주소 등 모든 정보 정상 표시
- 2025-05-29: **복지서비스 가격 정책 및 UI 수정 완료** ✨💰
  - 모든 복지서비스를 시간당 요금제로 변경
  - 일상가사 돌봄(30,000원/시간), 가정간병 돌봄(40,000원/시간), 정서지원 돌봄(20,000원/시간)
  - 필터 버튼을 카테고리별로 변경 (무료/유료 → 가사지원/간병지원/정서지원)
  - 실시간 가격 계산 로직 개선 및 상세한 가격 정보 표시
- 2025-05-29: 복지 서비스 예약 기능 개선 완료
  - 슬라이드 3개 서비스만 예약 가능하도록 제한
  - 2단계 예약 정보 입력 프로세스 구현
  - 예약자 정보 입력 폼 추가 (이름, 생년월일, 성별, 주소, 연락처 등)
  - 예약 상세 정보 모달 구현
  - 예약 내역 클릭 시 상세 정보 표시 기능
- 2025-05-25: 프로젝트 초기 분석 및 실행 방법 정리
- 2025-05-25: 음성 소비내역 입력 문제 해결
  - API URL 환경변수 수정 (localhost:9090 → localhost:5000)
  - 음성 입력 → 소비내역 표시 연동 확인
- 2025-05-26: 음성채팅 UI 개선 ✅
  - 전송 버튼 텍스트 가로 표시 CSS 수정
  - writing-mode: horizontal-tb 적용으로 "전송" 텍스트 정상 표시
- 2025-05-26: 소비내역 조회 오류 수정 ✅
  - ConsumptionController.js에서 `consumptionNo` → `consumption_no` 컬럼명 수정
  - NotificationController.js에서 `notificationNo` → `notification_no` 컬럼명 수정
  - ConsumptionService.js 완전 재작성 (구 모델 → 신 모델 구조로 변경)
    - `consumptionAmount` → `amount`
    - `consumptionCategory` → `category`
    - `consumptionDescription` → `memo`
    - `consumptionDate` → `transactionDate`
  - PostgreSQL DATE_TRUNC 함수 단위 수정 (`'DATE'` → `'day'`, `'WEEK'` → `'week'`, `'MONTH'` → `'month'`)
  - 라우트 우선순위 수정 (`/stats/:period`, `/report`, `/analysis`를 `/:consumptionId`보다 앞에 배치)
  - 데이터베이스 컬럼명과 Sequelize 쿼리 일치성 확보
- 2025-05-26: 텍스트 입력 및 소비내역 조회 기능 추가 ✅
  - chatScript.js에 소비내역 조회 함수 추가 (`getExpenseHistory`, `isExpenseInquiry`, `formatExpenseHistory`)
  - processAIResponse 함수에 소비내역 조회 로직 추가
  - 텍스트 입력으로도 소비내역 입력 및 조회 가능
  - "현재 내 소비내역 알려줄래?" 같은 질문에 실제 데이터 응답
- 2025-05-26: /consumption 페이지 UI 개선 ✅
  - 카테고리별 소비 현황(막대 차트) 제거
  - 소비 추이(라인 차트), 카테고리별 소비 비율(도넛 차트), 요약 정보 유지
  - 파이 차트를 도넛 차트로 개선 (중앙에 총 소비 금액 표시)
  - ConsumList(소비 내역 리스트)와 카테고리 필터 유지
  - 차트 제목 "소비 현황" → "소비 분석"으로 변경
- 2025-05-26: 금액 표시 포맷팅 개선 ✅
  - 모든 금액 표시에서 .00 소수점 제거
  - ConsumList.js, ConsumCard.js, ConsumDetailModal.js, ExpenseChart.js 수정
  - Math.floor()와 parseFloat() 사용하여 정수 변환 처리
  - 천 단위 콤마 구분자 유지
- 2025-05-26: 미사용 API 경로 정리 ✅
  - `/api/v1/match` 경로가 사용되지 않음을 확인
  - 프론트엔드, 백엔드, AI 서버 전체에서 해당 API 호출 코드 없음
  - 백엔드에서 해당 경로에 대한 명시적 차단 미들웨어 추가 (410 상태코드)
  - 불필요한 API 요청으로 인한 404 에러 방지
- 2025-05-26: AI 챗봇 소비내역 조회 기능 대폭 개선 ✅
  - 기간별 소비내역 조회 지원 (오늘/어제/이번주/지난주/이번달/지난달)
  - 구체적 월 지정 지원 ("4월 소비 리포트", "3월 내역" 등)  
  - 이번주 날짜 계산 로직 수정 (월요일~일요일 전체 주 표시)
  - 사용자 요청에 맞는 적절한 응답 포맷 구현
  - 일반 조회 vs 리포트 조회 구분 처리
  - 날짜별 그룹핑 및 음성 친화적 응답 생성
  - 카테고리별 통계 분석 및 퍼센트 계산 기능
  - 과거 날짜 소비내역 입력 기능 추가 ✨
    * "어제 5천원 점심 먹었어", "3일전 2만원 쇼핑했어" 등
    * "5월 20일에 1만원 썼어", "15일에 커피 마셨어" 등
    * 프론트엔드: parseExpenseFromInput 함수 날짜 파싱 기능 추가
    * 백엔드: ConsumptionController, ConsumptionService transactionDate 지원
- 2025-05-26: 대화형 소비내역 입력 시스템 구현 완료 ✨
  - 날짜 없는 소비내역 입력 시 AI가 날짜 확인하는 대화 플로우 추가
  - 사용자: "8000원 점심 먹었어" → AI: "언제 드셨나요?" → 사용자: "어제" → AI: "5월 25일로 저장했어요!"
  - 대화 상태 관리 시스템 (pendingExpenseData, waitingForDateConfirmation)
  - 날짜 파싱 확장 ("오늘", "어제", "3일 전", "5월 20일" 등)
  - 사용자 친화적 날짜 확인 메시지 생성
  - 기존 날짜 포함 소비내역은 즉시 저장 (기존 기능 유지)
  - chatScript.js 완전 재작성으로 대화형 시스템 구현
- 2025-05-27: **구조 리팩토링 완료** ✨🏗️
  - **문제**: 프론트엔드에 비즈니스 로직과 서비스 로직이 과도하게 집중됨
  - **백엔드 개선**:
    * `aiChatService.js` 생성 - AI 처리 로직 백엔드로 이관
    * 소비내역 파싱, 날짜 계산, 카테고리 추론 로직 백엔드로 이동
    * 대화형 처리, 응답 생성 로직 백엔드로 이동
    * `consumptionService.js`에 기간별 날짜 범위 계산 함수 추가
    * `aiChatController.js`, `aiChatRoutes.js` 생성
    * API 엔드포인트: `/api/v1/ai-chat/message`, `/api/v1/ai-chat/reset-session`
  - **프론트엔드 단순화**:
    * `chatScript_new.js` 생성 - UI 로직만 남기고 비즈니스 로직 제거
    * 백엔드 API 호출 중심으로 단순화
    * 음성 인식, UI 상태 관리만 프론트엔드에서 처리
    * 서비스 로직은 백엔드 API로 완전 이관
  - **아키텍처 개선**:
    * 관심사 분리: UI ↔ 비즈니스 로직 완전 분리
    * 확장성 향상: 비즈니스 로직 중앙화
    * 유지보수성 개선: 단일 책임 원칙 적용
- 2025-05-27: **회원가입 정보 입력 개선** ✨
  - **추가된 필드**: 생년월일, 성별 입력 필드 추가
  - **프론트엔드 개선**:
    * InfoInput.js에 생년월일(date input), 성별(select) 필드 추가
    * 필드 validation 로직 업데이트 (모든 필드 필수)
    * CSS 스타일링 개선 (date input, select 요소)
  - **백엔드 개선**:
    * users.js 라우터에 생년월일, 성별 validation 추가
    * 기존 User 모델에 이미 userBirth, userGender 필드 존재 확인
  - **DB 구조**: 별도 수정 불필요 (이미 필드 존재)
  - **입력 필드**: 이름, 전화번호, 생년월일, 성별 (4개 필드 모두 필수)
- 2025-05-27: **지병 선택 페이지 추가** ✨🏥
  - **새로운 페이지**: `/signup/diseaseselect` 추가
  - **회원가입 플로우 개선**:
    * infoinput → diseaseselect → verifycode 순서로 변경
    * 기존: infoinput → verifycode
    * 개선: infoinput → diseaseselect → verifycode
  - **지병 선택 기능**:
    * 카테고리별 질병 분류 (만성질환, 중증질환, 정신건강, 기타)
    * 복수 선택 가능
    * "없음" 선택 시 다른 선택 자동 해제
    * 선택된 항목 실시간 요약 표시
  - **포함된 질병**: 당뇨병, 고혈압, 심장병, 관절염, 뇌졸중, 암, 신장질환, 간질환, 폐질환, 골다공증, 우울증, 치매, 기타
  - **UI/UX**: 직관적인 선택 인터페이스, 카테고리별 그룹핑, 선택 상태 시각적 피드백
  - **데이터 저장**: 기존 User 모델의 `userDisease` 필드 활용
  - **라우팅 업데이트**: App.js, SignUpHeader.js, 네비게이션 링크 모두 수정 완료
  - **UI 개선**: 직접 입력 필드 추가, 이전/다음 버튼 하단 고정
    * 직접 입력 필드로 목록에 없는 질병 추가 가능
    * "없음" 선택 시 직접 입력 필드 비활성화
    * 버튼을 화면 하단에 고정하여 스크롤과 관계없이 접근 가능
